<!DOCTYPE html>

<div class="project-section-header" data-ng-include="'partials/project/blocks/project-menu.html'"></div>

<div class="project-section-content">
    <div class="project-section-description-column">
        <div data-ng-if="!form.isOpen('image')" class="project-section-description-image">
            <img data-ng-src="{{projectData.project.description.image | uploadedImage:'media/image_default.png'}}"
                 src=""/>

            <div data-ng-if="!form.isOpen()" class="project-description-block-edit-controls btn-group">
                <button type="button" class="btn btn-default" data-ng-click="form.open('image')">Edit
                </button>
            </div>
        </div>
        <div data-ng-if="form.isOpen('image')">
            <form role="form">
                <div class="form-group">
                    <label for="file-select-input-image">Project image:</label>

                    <div id="file-select-input-image" data-siw-file-select-widget data-ng-attr-filekey="image"
                         data-ng-attr-original="{{form.values.description.image}}">
                    </div>
                </div>
                <div class="btn-group">
                    <button type="button" class="btn btn-default" data-ng-click="form.save()">Save</button>
                    <button type="button" class="btn btn-default" data-ng-click="form.cancel()">Cancel</button>
                </div>
            </form>
        </div>

        <div data-ng-if="!form.isOpen('title')" class="project-section-description-text">
            <p class="project-section-description-text-title">
                <span class="project-section-description-text-mission">Title: </span>
                {{projectData.project.title}}
            </p>

            <p class="project-section-description-text-title">
                <span class="project-section-description-text-mission">Teaser: </span>
                {{projectData.project.description.teaser}}
            </p>

            <p data-ng-if="!form.isOpen()" class="btn-group">
                <button type="button" class="btn btn-default" data-ng-click="form.open('title')">Edit</button>
            </p>
        </div>

        <div data-ng-if="form.isOpen('title')">
            <form role="form">
                <div class="form-group">
                    <label for="project-title">Title:</label>
                    <input id="project-title" class="form-control" type="text" placeholder="Title" data-ng-model="form.values.title"/>
                </div>
                <div class="form-group">
                    <label for="project-teaser">Teaser:</label>
                    <input id="project-teaser" class="form-control" type="text"  placeholder="Teaser"
                           data-ng-model="form.values.description.teaser"/>
                </div>

                <div class="btn-group">
                    <button type="button" class="btn btn-default" data-ng-click="form.save()">Save</button>
                    <button type="button" class="btn btn-default" data-ng-click="form.cancel()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div class="project-section-content-column">
        <p class="project-section-content-header">Mission description</p>

        <div class="project-section-content-description-block"
             data-ng-repeat="block in projectData.project.description.blocks">

            <div data-ng-if="!form.isOpen('block:' + $index)">
                <p class="project-section-content-description-block-title">{{block.title}}</p>

                <p class="project-section-content-description-block-content">{{block.content}}</p>

                <div data-ng-if="!form.isOpen()" class="btn-group">
                    <button type="button" class="btn btn-default" data-ng-click="form.open('block:' + $index)">
                        Edit
                    </button>
                    <button type="button" class="btn btn-default" data-ng-disabled="$last"
                            data-ng-click="moveMetadataBlock($index, false)">
                        Move down
                    </button>
                    <button type="button" class="btn btn-default" data-ng-disabled="$index < 1"
                            data-ng-click="moveMetadataBlock($index, true)">
                        Move up
                    </button>
                    <button type="button" class="btn btn-default" data-ng-click="deleteMetadataBlock($index)">
                        Delete
                    </button>
                </div>
            </div>

            <div data-ng-if="form.isOpen('block:' + $index)">
                <form role="form">
                    <div class="form-group">
                        <label for="block-block-title">Title:</label>
                        <input id="block-block-title" class="form-control" type="text"  placeholder="Title"
                               data-ng-model="form.values.description.blocks[$index].title"/>
                    </div>
                    <div class="form-group">
                        <label for="project-block-content">Text:</label>
                        <textarea id="project-block-content" class="form-control"
                                  data-ng-model="form.values.description.blocks[$index].content"
                                  placeholder="Content"></textarea>
                    </div>
                    <div class="btn-group">
                        <button type="button" class="btn btn-default" data-ng-click="form.save()">Save</button>
                        <button type="button" class="btn btn-default" data-ng-click="form.cancel()">Cancel</button>
                    </div>
                </form>
            </div>
        </div>

        <p class="project-section-content-column-add-block" data-ng-if="!form.isOpen()">
            <button type="button" class="btn btn-default" data-ng-click="addMetadataBlock()">Add block</button>
        </p>
    </div>
</div>

